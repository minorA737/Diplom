<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="using:ManufactPlanner.Converters"
        mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="700"
        x:Class="ManufactPlanner.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        xmlns:vm="using:ManufactPlanner.ViewModels"
        Icon="/Assets/avalonia-logo.ico"
        Title="ManufactPlanner"
        TransparencyLevelHint="AcrylicBlur"
        Background="Transparent"
        WindowStartupLocation="CenterScreen">

	<Window.Resources>
		<converters:BoolToValueConverter x:Key="BoolToValue"/>
		<converters:IsGreaterThanConverter x:Key="IsGreaterThan"/>
		<converters:StringEqualsValueConverter x:Key="StringEqualsValue"/>
		<converters:MarginConverter x:Key="MarginConverter"/>
		<converters:PercentToWidthConverter x:Key="PercentToWidthConverter"/>
		<converters:AuthMarginConverter x:Key="AuthMarginConverter"/>
	</Window.Resources>

	<Window.Styles>
		<!-- Базовый стиль для всех навигационных кнопок -->
		<Style Selector="Button.navButton">
			<Setter Property="Height" Value="40"/>
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="Opacity" Value="0.9"/>
			<Setter Property="Margin" Value="5,5"/>
			<Setter Property="Padding" Value="5,0"/>
			<Setter Property="CornerRadius" Value="4"/>
			<Setter Property="HorizontalContentAlignment" Value="Left"/>
			<!-- Удалим фиксированную ширину, она будет определяться в зависимости от состояния панели -->
		</Style>

		<!-- Стиль для кнопок при развернутой навигационной панели -->
		<Style Selector="Button.navButton[Tag=expanded]">
			<Setter Property="Width" Value="180"/>
			<Setter Property="Margin" Value="10,5"/>
			<Setter Property="Padding" Value="10,0"/>
		</Style>

		<!-- Стиль для кнопок при свернутой навигационной панели -->
		<Style Selector="Button.navButton[Tag=collapsed]">
			<Setter Property="Width" Value="50"/>
			<Setter Property="Margin" Value="5,5"/>
			<Setter Property="Padding" Value="5,0"/>
			<Setter Property="HorizontalContentAlignment" Value="Center"/>
		</Style>

		<!-- Стиль при наведении -->
		<Style Selector="Button.navButton:pointerover">
			<Setter Property="Background" Value="#008999"/>
			<Setter Property="Opacity" Value="1"/>
		</Style>

	</Window.Styles>

	<Grid>
		<!-- Основной фон -->
		<Border Background="{DynamicResource BackgroundBrush}"/>

		<Grid RowDefinitions="60,*" ColumnDefinitions="Auto,*">
			<!-- Верхняя панель -->
			<Border Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                    Background="{DynamicResource SurfaceBrush}"
                    IsVisible="{Binding IsAuthenticated}">
				<Grid>
					<!-- Содержимое верхней панели... -->
					<StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0,0,0">
						<Ellipse Width="40" Height="40" Fill="{DynamicResource PrimaryBrush}"/>
						<TextBlock Text="ManufactPlanner" FontSize="16" FontWeight="SemiBold"
                                  Foreground="{DynamicResource TextPrimaryBrush}" VerticalAlignment="Center" Margin="10,0,0,0"/>
					</StackPanel>

					<!-- Поиск -->
					<Border Width="300" Height="30" CornerRadius="15" Background="{DynamicResource BackgroundBrush}"
                            BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" HorizontalAlignment="Center">
						<TextBox Watermark="Поиск..." BorderThickness="0" Background="Transparent"
                                 Foreground="{DynamicResource TextPrimaryBrush}"
                                 VerticalAlignment="Center" Padding="15,0,0,0"/>
					</Border>

				<!-- Профиль и уведомления -->
				<StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0">
					<!-- Уведомления -->
					<Border Width="30" Height="30" CornerRadius="15" Background="{DynamicResource BackgroundBrush}"
						BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Margin="0,0,20,0">
						<Grid>
							<Ellipse Width="10" Height="10" Fill="{DynamicResource WarningBrush}" VerticalAlignment="Center" HorizontalAlignment="Center"/>
							<Border Width="12" Height="12" CornerRadius="6" Background="{DynamicResource ErrorBrush}"
									VerticalAlignment="Top" HorizontalAlignment="Right" Margin="0,-2,-2,0"
									IsVisible="{Binding UnreadNotificationsCount, Converter={StaticResource IsGreaterThan}, ConverterParameter='0'}">
								<TextBlock Text="{Binding UnreadNotificationsCount}" FontSize="9" Foreground="White"
											HorizontalAlignment="Center" VerticalAlignment="Center"/>
							</Border>
						</Grid>
					</Border>

					<!-- Профиль -->
					<Border Width="40" Height="40" CornerRadius="20" Background="#9575CD" Opacity="0.7">
						<TextBlock Text="АП" FontSize="14" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
					</Border>
					<Button Margin="10,0,0,0" Background="Transparent" Command="{Binding Logout}">
						<TextBlock Text="Выход" Foreground="#333" VerticalAlignment="Center"/>
					</Button>
				</StackPanel>
			</Grid>
		</Border>

			<!-- Боковая панель навигации (только в первом столбце и второй строке) -->
			<!-- Боковая панель навигации (только в первом столбце и второй строке) -->
			<Grid Grid.Row="1" Grid.Column="0"
				  Width="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='60,200'}"
				  IsVisible="{Binding IsAuthenticated}">
				<!-- Фон с тенью -->
				<Border Background="{DynamicResource SidebarGradient}"
						BoxShadow="2 0 3 #10000000"
						CornerRadius="0,4,4,0">
					<StackPanel Margin="0,20,0,0">
						<!-- Дашборд -->
						<Button Classes="navButton" Command="{Binding NavigateToDashboard}"
								Tag="{Binding CurrentMenuItem, Converter={StaticResource StringEqualsValue}, ConverterParameter='dashboard'}"
								Width="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='50,180'}"
								HorizontalAlignment="Left"
								Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='5 5,10 5'}">
							<StackPanel Orientation="Horizontal">
								<TextBlock Text="🏠" FontSize="14" VerticalAlignment="Center"
										  HorizontalAlignment="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='Center,Left'}"
										  Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='0,0 0 10 0'}"/>
								<TextBlock Text="Дашборд" VerticalAlignment="Center" IsVisible="{Binding !IsSidebarCollapsed}"/>
							</StackPanel>
						</Button>

						<!-- Заказы -->
						<Button Classes="navButton" Command="{Binding NavigateToOrders}"
								Tag="{Binding CurrentMenuItem, Converter={StaticResource StringEqualsValue}, ConverterParameter='orders'}"
								Width="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='50,180'}"
								HorizontalAlignment="Left"
								Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='5 5,10 5'}">
							<StackPanel Orientation="Horizontal">
								<TextBlock Text="📋" FontSize="14" VerticalAlignment="Center"
										  HorizontalAlignment="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='Center,Left'}"
										  Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='0,0 0 10 0'}"/>
								<TextBlock Text="Заказы" VerticalAlignment="Center" IsVisible="{Binding !IsSidebarCollapsed}"/>
							</StackPanel>
						</Button>

						<!-- Задачи -->
						<Button Classes="navButton" Command="{Binding NavigateToTasks}"
								Tag="{Binding CurrentMenuItem, Converter={StaticResource StringEqualsValue}, ConverterParameter='tasks'}"
								Width="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='50,180'}"
								HorizontalAlignment="Left"
								Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='5 5,10 5'}">
							<StackPanel Orientation="Horizontal">
								<TextBlock Text="✓" FontSize="14" VerticalAlignment="Center"
										  HorizontalAlignment="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='Center,Left'}"
										  Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='0,0 0 10 0'}"/>
								<TextBlock Text="Задачи" VerticalAlignment="Center" IsVisible="{Binding !IsSidebarCollapsed}"/>
							</StackPanel>
						</Button>

						<!-- Календарь -->
						<Button Classes="navButton" Command="{Binding NavigateToCalendar}"
								Tag="{Binding CurrentMenuItem, Converter={StaticResource StringEqualsValue}, ConverterParameter='calendar'}"
								Width="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='50,180'}"
								HorizontalAlignment="Left"
								Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='5 5,10 5'}">
							<StackPanel Orientation="Horizontal">
								<TextBlock Text="📅" FontSize="14" VerticalAlignment="Center"
										  HorizontalAlignment="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='Center,Left'}"
										  Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='0,0 0 10 0'}"/>
								<TextBlock Text="Календарь" VerticalAlignment="Center" IsVisible="{Binding !IsSidebarCollapsed}"/>
							</StackPanel>
						</Button>

						<!-- Документация -->
						<Button Classes="navButton" Command="{Binding NavigateToDocumentation}"
								Tag="{Binding CurrentMenuItem, Converter={StaticResource StringEqualsValue}, ConverterParameter='documentation'}"
								Width="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='50,180'}"
								HorizontalAlignment="Left"
								Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='5 5,10 5'}">
							<StackPanel Orientation="Horizontal">
								<TextBlock Text="📄" FontSize="14" VerticalAlignment="Center"
										  HorizontalAlignment="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='Center,Left'}"
										  Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='0,0 0 10 0'}"/>
								<TextBlock Text="Документация" VerticalAlignment="Center" IsVisible="{Binding !IsSidebarCollapsed}"/>
							</StackPanel>
						</Button>

						<!-- Производство -->
						<Button Classes="navButton" Command="{Binding NavigateToProduction}"
								Tag="{Binding CurrentMenuItem, Converter={StaticResource StringEqualsValue}, ConverterParameter='production'}"
								Width="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='50,180'}"
								HorizontalAlignment="Left"
								Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='5 5,10 5'}">
							<StackPanel Orientation="Horizontal">
								<TextBlock Text="🏭" FontSize="14" VerticalAlignment="Center"
										  HorizontalAlignment="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='Center,Left'}"
										  Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='0,0 0 10 0'}"/>
								<TextBlock Text="Производство" VerticalAlignment="Center" IsVisible="{Binding !IsSidebarCollapsed}"/>
							</StackPanel>
						</Button>

						<!-- Аналитика -->
						<Button Classes="navButton" Command="{Binding NavigateToAnalytics}"
								Tag="{Binding CurrentMenuItem, Converter={StaticResource StringEqualsValue}, ConverterParameter='analytics'}"
								Width="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='50,180'}"
								HorizontalAlignment="Left"
								Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='5 5,10 5'}">
							<StackPanel Orientation="Horizontal">
								<TextBlock Text="📊" FontSize="14" VerticalAlignment="Center"
										  HorizontalAlignment="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='Center,Left'}"
										  Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='0,0 0 10 0'}"/>
								<TextBlock Text="Аналитика" VerticalAlignment="Center" IsVisible="{Binding !IsSidebarCollapsed}"/>
							</StackPanel>
						</Button>

						<!-- Настройки -->
						<Button Classes="navButton" Command="{Binding NavigateToSettings}"
								Tag="{Binding CurrentMenuItem, Converter={StaticResource StringEqualsValue}, ConverterParameter='settings'}"
								Width="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='50,180'}"
								HorizontalAlignment="Left"
								Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='5 5,10 5'}">
							<StackPanel Orientation="Horizontal">
								<TextBlock Text="⚙️" FontSize="14" VerticalAlignment="Center"
										  HorizontalAlignment="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='Center,Left'}"
										  Margin="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='0,0 0 10 0'}"/>
								<TextBlock Text="Настройки" VerticalAlignment="Center" IsVisible="{Binding !IsSidebarCollapsed}"/>
							</StackPanel>
						</Button>
					</StackPanel>
				</Border>
			</Grid>

			<!-- Кнопка сворачивания/разворачивания боковой панели -->
			<Button Grid.Row="1" Grid.Column="0"
					Width="24" Height="24"
					HorizontalAlignment="Right" VerticalAlignment="Top"
					Margin="0,10,0,0"
					Background="Transparent" BorderThickness="0"
					Command="{Binding ToggleSidebar}"
					ZIndex="2"
					IsVisible="{Binding IsAuthenticated}">
				<TextBlock Text="{Binding IsSidebarCollapsed, Converter={StaticResource BoolToValue}, ConverterParameter='❯,❮'}"
						  FontSize="12" Foreground="White"/>
			</Button>

			<!-- Основная область контента (второй столбец, вторая строка) -->
			<ContentPresenter Grid.Row="1" Grid.Column="1"
							  Content="{Binding CurrentView}"
							  IsVisible="True" />
		</Grid>
	</Grid>
</Window>