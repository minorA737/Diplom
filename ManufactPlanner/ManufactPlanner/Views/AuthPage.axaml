<UserControl xmlns="https://github.com/avaloniaui"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
            mc:Ignorable="d"
            x:Class="ManufactPlanner.Views.AuthPage"
            x:DataType="vm:AuthViewModel"
            xmlns:vm="using:ManufactPlanner.ViewModels"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch">

	<!-- Стили для анимаций -->
	<UserControl.Styles>
		<Style Selector="Border.loginCard">
			<Setter Property="Opacity" Value="0"/>
			<Setter Property="Transitions">
				<Transitions>
					<DoubleTransition Property="Opacity" Duration="0:0:0.5"/>
					<TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.4" Easing="CubicEaseOut"/>
				</Transitions>
			</Setter>
			<Setter Property="RenderTransform" Value="translateY(30px)"/>
		</Style>
		<Style Selector="Border.loginCard[IsVisible=true]">
			<Setter Property="Opacity" Value="1"/>
			<Setter Property="RenderTransform" Value="translateY(0px)"/>
		</Style>

		<Style Selector="Border.input">
			<Setter Property="Transitions">
				<Transitions>
					<BrushTransition Property="BorderBrush" Duration="0:0:0.2"/>
				</Transitions>
			</Setter>
		</Style>
		<Style Selector="Border.input:pointerover">
			<Setter Property="BorderBrush" Value="{DynamicResource PrimaryBrush}"/>
		</Style>

		<Style Selector="Button.login">
			<Setter Property="Transitions">
				<Transitions>
					<BrushTransition Property="Background" Duration="0:0:0.2"/>
					<TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.1"/>
				</Transitions>
			</Setter>
		</Style>
		<Style Selector="Button.login:pointerover">
			<Setter Property="Background" Value="#008FA0"/>
			<Setter Property="RenderTransform" Value="scale(1.02)"/>
		</Style>
		<Style Selector="Button.login:pressed">
			<Setter Property="RenderTransform" Value="scale(0.98)"/>
		</Style>
	</UserControl.Styles>

	<Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
          Margin="0">
		<!-- Убрано пустое пространство сверху -->

		<!-- Градиентный фон на всю страницу -->
		<Grid>
			<Grid.Background>
				<LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
					<GradientStop Offset="0" Color="#F0F3F7"/>
					<GradientStop Offset="1" Color="#E4EAF1"/>
				</LinearGradientBrush>
			</Grid.Background>

			<!-- Декоративные элементы -->
			<Ellipse Width="300" Height="300" Fill="{DynamicResource PrimaryBrush}" Opacity="0.05"
                     HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="-50,0,0,-50"/>
			<Ellipse Width="200" Height="200" Fill="#009688" Opacity="0.06"
                     HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,-50,-50,0"/>
		</Grid>

		<!-- Карточка авторизации -->
		<Border Classes="loginCard" Width="340" Height="480" Background="White" CornerRadius="12"
                BoxShadow="0 10 30 #20000000"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                IsVisible="True">

			<!-- Содержимое карточки -->
			<Grid RowDefinitions="90,Auto,*,Auto">
				<!-- Шапка (исправлена - теперь точно вверху) -->
				<Rectangle Grid.Row="0" Fill="{DynamicResource PrimaryBrush}"/>

				<!-- Логотип и заголовок -->
				<StackPanel Grid.Row="1" VerticalAlignment="Top" Margin="0,-35,0,0">
					<Border Width="70" Height="70" CornerRadius="35" BoxShadow="0 4 15 #30000000"
                        Background="White" HorizontalAlignment="Center">
						<TextBlock Text="MP" FontSize="24" FontWeight="Bold" Foreground="{DynamicResource PrimaryBrush}"
                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
					</Border>
					<TextBlock Text="Вход в систему" FontSize="20" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"
                               HorizontalAlignment="Center" Margin="0,20,0,0"/>
				</StackPanel>

				<!-- Форма входа -->
				<StackPanel Grid.Row="2" Margin="35,15,35,0">
					<!-- Поле логина -->
					<Border Classes="input" Height="48" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                            CornerRadius="6" Margin="0,0,0,15">
						<Grid>
							<TextBlock Text="Имя пользователя" Foreground="#9E9E9E" FontSize="12"
                                      Margin="10,8,0,0" IsVisible="{Binding !HasUsername}"/>
							<TextBox Text="{Binding Username}" Background="Transparent" BorderThickness="0"
                                    VerticalAlignment="Center" Margin="10,0,0,0"/>
						</Grid>
					</Border>

					<!-- Поле пароля -->
					<Border Classes="input" Height="48" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                            CornerRadius="6" Margin="0,0,0,15">
						<Grid>
							<TextBlock Text="Пароль" Foreground="#9E9E9E" FontSize="12"
                                      Margin="10,8,0,0" IsVisible="{Binding !HasPassword}"/>
							<TextBox Text="{Binding Password}" PasswordChar="•" Background="Transparent"
                                    BorderThickness="0" VerticalAlignment="Center" Margin="10,0,0,0"/>
						</Grid>
					</Border>

					<!-- Запомнить меня - исправлено выравнивание -->
					<Grid Margin="0,0,0,15">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto"/>
							<ColumnDefinition Width="*"/>
						</Grid.ColumnDefinitions>
						<CheckBox Grid.Column="0" IsChecked="{Binding RememberMe}" VerticalAlignment="Center">
							<CheckBox.Styles>
								<Style Selector="CheckBox:checked /template/ Border#NormalRectangle">
									<Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
									<Setter Property="BorderBrush" Value="{DynamicResource PrimaryBrush}"/>
								</Style>
							</CheckBox.Styles>
						</CheckBox>
						<TextBlock Grid.Column="1" Text="Запомнить меня" FontSize="12" Foreground="{DynamicResource TextPrimaryBrush}"
                                  VerticalAlignment="Center" Margin="5,0,0,0"/>
					</Grid>

					<!-- Кнопка входа - исправлено центрирование текста -->
					<Button Classes="login" HorizontalAlignment="Stretch"
                            Height="48" Background="{DynamicResource PrimaryBrush}" Foreground="White" CornerRadius="6"
                            FontSize="14" FontWeight="Medium" Margin="0,0,0,15"
                            Command="{Binding LoginCommand}">
						<TextBlock Text="ВОЙТИ" HorizontalAlignment="Center" VerticalAlignment="Center"/>
					</Button>

					<ProgressBar IsIndeterminate="True" IsVisible="{Binding IsLoading}"
                        Height="4" Margin="0,0,0,15" Foreground="{DynamicResource PrimaryBrush}"/>

				</StackPanel>

				<!-- Футер (подпись о правах) - перемещен вниз -->
				<TextBlock Grid.Row="3" Text="© 2025 ManufactPlanner. Все права защищены."
                          FontSize="11" Foreground="#9E9E9E"
                          HorizontalAlignment="Center" VerticalAlignment="Bottom"
                          Margin="0,10,0,15"/>

				
			</Grid>
			
		</Border>
		<!-- Сообщение об ошибке - исправлено отображение -->
		<Border Background="#FFEFE9" CornerRadius="4" Padding="10"
				IsVisible="{Binding HasError}" Margin="0,0,0,0" VerticalAlignment="Bottom">
			<StackPanel Orientation="Horizontal">
				<TextBlock Text="⚠️" FontSize="14" Margin="0,0,8,0" VerticalAlignment="Center"/>
				<TextBlock Text="{Binding ErrorMessage}" Foreground="#D32F2F"
						  FontSize="12" TextWrapping="Wrap" VerticalAlignment="Center"/>
			</StackPanel>
		</Border>
	</Grid>
</UserControl>